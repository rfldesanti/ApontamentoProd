Private Sub Worksheet_Change(ByVal Target As Range)

If Target = ordem_prod Then
    If ordem_prod.Value <> "" Then
        If Not IsError(Application.Match(ordem_prod, registros.Range("A:A"), 0)) Then
            registros.AutoFilterMode = False
            registros.UsedRange.AutoFilter 1, ordem_prod
            Call ContaLinhas
            If Not IsEmpty(registros.Cells(UltimaLinha - 1, 3)) Then
                MsgBox "Vou formatar como entrada!"
            Else
                MsgBox "Vou fomatar como sa√≠da!"
            End If
        Else
            MsgBox "Vou formatar como entrada!"
        End If
    End If
End If
registros.AutoFilterMode = False
End Sub
