Private Sub Worksheet_Change(ByVal Target As Range)

'If Target = ordem_prod Then
If Not Intersect(ordem_prod, Target) Is Nothing Then
    If ordem_prod.Value <> "" Then
        If Not IsError(Application.Match(ordem_prod, registros.Range("A:A"), 0)) Then
            registros.AutoFilterMode = False
            registros.UsedRange.AutoFilter 1, ordem_prod
            Call ContaLinhas
            If Not IsEmpty(registros.Cells(UltimaLinha - 1, 3)) Then
                MsgBox "Vou formatar como entrada!"
                
                ApontaOP.Unprotect "TESTE"
                'Limpar dados de mq caso a OP seja deletada
                If mq.Locked Then
                    mq.Locked = False
                    mq.ClearContents
                End If
                With ApontaOP.Range("J2")
                    .HorizontalAlignment = xlCenter
                    .VerticalAlignment = xlCenter
                End With
                
                ApontaOP.Range("J2:L3").Merge
                
                Set sMerge = ApontaOP.Range("J2:L3")
                
                With sMerge
                    .Value = "REGISTRAR INÍCIO DE PRODUÇÃO - ENTRADA DE OP NA MÁQUINA"
                    .BorderAround ColorIndex:=3
                    .Interior.ColorIndex = 5
                    With .Font
                        .Bold = True
                        .Color = RGB(255, 255, 255)
                    End With
                End With
                ApontaOP.Protect "TESTE"
                'Desproteger a Planilha
                'Realizar as formatações
            Else
                MsgBox "Vou fomatar como saída!"
                ApontaOP.Unprotect "TESTE"
                With ApontaOP.Range("J2")
                    .HorizontalAlignment = xlCenter
                    .VerticalAlignment = xlCenter
                End With
                
                ApontaOP.Range("J2:L3").Merge
                
                Set sMerge = ApontaOP.Range("J2:L3")
                
                With sMerge
                    .Value = "REGISTRAR FINAL DE PRODUÇÃO - SAÍDA DE OP DA MÁQUINA"
                    .BorderAround ColorIndex:=3
                    .Interior.ColorIndex = 45
                    With .Font
                        .Bold = True
                        .Color = RGB(255, 255, 255)
                        
                    End With
                End With
                Call BuscaMQ
                mq.Locked = True
                ApontaOP.Protect "TESTE"
                'Desproteger a Planilha
                'Realizar as formatações
            End If
        Else
            MsgBox "Vou formatar como entrada!"
            ApontaOP.Unprotect "TESTE"
            'Limpar dados de mq caso a OP seja deletada
            If mq.Locked Then
                mq.Locked = False
                mq.ClearContents
            End If
            With ApontaOP.Range("J2")
                .HorizontalAlignment = xlCenter
                .VerticalAlignment = xlCenter
            End With
            ApontaOP.Range("J2:L3").Merge
                
            Set sMerge = ApontaOP.Range("J2:L3")
                
            With sMerge
                .Value = "REGISTRAR INÍCIO DE PRODUÇÃO - ENTRADA DE OP NA MÁQUINA"
                .BorderAround ColorIndex:=3
                .Interior.ColorIndex = 5
                With .Font
                    .Bold = True
                    .Color = RGB(255, 255, 255)
                End With
            End With
            ApontaOP.Protect "TESTE"
            'Desproteger a Planilha
            'Realizar as formatações
        End If
    Else
        If mq.Locked Then
            ApontaOP.Unprotect "TESTE"
            mq.Locked = False
            mq.ClearContents
            id_funcionario.ClearContents
            'ApontaOP.Unprotect "TESTE"
            ApontaOP.Range("J2:L4").Clear
            ApontaOP.Range("J2:L4").Interior.Color = RGB(255, 255, 255)
            ApontaOP.Protect "TESTE"
        Else
            ApontaOP.Unprotect "TESTE"
            ApontaOP.Range("J2:L4").Clear
            ApontaOP.Range("J2:L4").Interior.Color = RGB(255, 255, 255)
            ApontaOP.Protect "TESTE"
            ordem_prod.Activate
        End If
    End If
End If
registros.AutoFilterMode = False
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

If ordem_prod = " " Or IsEmpty(ordem_prod) Then
    If ActiveCell.Address <> ordem_prod.Address Then
        MsgBox "INFORME A ORDEM DE PRODUÇÃO!"
        ordem_prod.Activate
    End If
End If

End Sub