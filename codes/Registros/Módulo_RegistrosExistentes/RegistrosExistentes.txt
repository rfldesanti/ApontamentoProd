Sub RegistroExistente()

funcionario = Application.Match(id_funcionario, db_funcionarios.Range("A:A"), 0)

If IsError(funcionario) Then
    MsgBox "Nao foi possivel encontrar o funcionario informado"
    id_funcionario.ClearContents
    Call botao
Else
    registros.AutoFilterMode = False
    registros.UsedRange.AutoFilter 1, ordem_prod
    Call ContaLinhas
    If IsEmpty(registros.Cells(UltimaLinha - 1, 3)) Then
        registros.Cells(UltimaLinha - 1, 3).Value = Now()
        registros.Cells(UltimaLinha - 1, 13).Value = registros.Cells(UltimaLinha - 1, 11).Value
        registros.Cells(UltimaLinha - 1, 14).Value = id_funcionario
        registros.AutoFilterMode = False
    Else
        registros.AutoFilterMode = False
        Call RegistroNovo
    End If
End If
Exit Sub
End Sub